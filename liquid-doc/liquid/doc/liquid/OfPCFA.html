<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>3.2.4&nbsp;Option for Passing Continuation Function Arguments</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="file:///usr/share/doc/racket/local-redirect/local-redirect.js"></script><script type="text/javascript" src="file:///home/mordecai/.racket/6.1/doc/local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Racket Library Support for LIQUID</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="About_LIQUID.html" class="tocviewlink" data-pltdoc="x">About LIQUID</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Concepts.html" class="tocviewlink" data-pltdoc="x">Concepts</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Architecture.html" class="tocviewselflink" data-pltdoc="x">Architecture</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Reference.html" class="tocviewlink" data-pltdoc="x">Reference</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="Examples.html" class="tocviewlink" data-pltdoc="x">Examples</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="To-Do.html" class="tocviewlink" data-pltdoc="x">To-<wbr></wbr>Do</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" data-pltdoc="x">Index</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>3&nbsp;</td><td><a href="Architecture.html" class="tocviewlink" data-pltdoc="x">Architecture</a></td></tr></table><div class="tocviewsublist" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">3.1&nbsp;</td><td><a href="Dataplex.html" class="tocviewlink" data-pltdoc="x">Dataplex</a></td></tr><tr><td align="right">3.2&nbsp;</td><td><a href="Multiple_Execution_Path_Exits_Architecture.html" class="tocviewselflink" data-pltdoc="x">Multiple Execution Path Exits Architecture</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9660;</a></td><td>3.2&nbsp;</td><td><a href="Multiple_Execution_Path_Exits_Architecture.html" class="tocviewlink" data-pltdoc="x">Multiple Execution Path Exits Architecture</a></td></tr></table><div class="tocviewsublistbottom" style="display: block;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right">3.2.1&nbsp;</td><td><a href="The_Basic_Approach.html" class="tocviewlink" data-pltdoc="x">The Basic Approach</a></td></tr><tr><td align="right">3.2.2&nbsp;</td><td><a href="Reduction_to_Conventional_Functions.html" class="tocviewlink" data-pltdoc="x">Reduction to Conventional Functions</a></td></tr><tr><td align="right">3.2.3&nbsp;</td><td><a href="Why_Multiple_Continuations_are_Needed.html" class="tocviewlink" data-pltdoc="x">Why Multiple Continuations are Needed</a></td></tr><tr><td align="right">3.2.4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Option for Passing Continuation Function Arguments</a></td></tr><tr><td align="right">3.2.5&nbsp;</td><td><a href="More_on_the_Function-Args_Pair_Option.html" class="tocviewlink" data-pltdoc="x">More on the Function-<wbr></wbr>Args Pair Option</a></td></tr><tr><td align="right">3.2.6&nbsp;</td><td><a href="Manual_Method.html" class="tocviewlink" data-pltdoc="x">Manual Method</a></td></tr><tr><td align="right">3.2.7&nbsp;</td><td><a href="Eval_With_Scoped_Variables.html" class="tocviewlink" data-pltdoc="x">Eval With Scoped Variables</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;6.1&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;6.1&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<a href="Why_Multiple_Continuations_are_Needed.html" title="backward to &quot;3.2.3 Why Multiple Continuations are Needed&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Multiple_Execution_Path_Exits_Architecture.html" title="up to &quot;3.2 Multiple Execution Path Exits Architecture&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="More_on_the_Function-Args_Pair_Option.html" title="forward to &quot;3.2.5 More on the Function-Args Pair Option&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h5 x-source-module="(lib &quot;liquid/liquid.scrbl&quot;)" x-part-tag="&quot;OfPCFA&quot;">3.2.4<tt>&nbsp;</tt><a name="(part._.Of.P.C.F.A)"></a>Option for Passing Continuation Function Arguments</h5><p>The above code example was indeed our first implementation for <span class="RktSym">x-hash-ref</span>,
however we ran into a problem in that <span class="RktSym">continue-key-not-found</span> is called without
arguments.  If this function is to do any real work it must operate on something.</p><p>When a application programmer defines a function that accepts continuations, then the
programmer can handle the question of which arguments should be passed into the
continuation calls.  After all, he also wrote the continuation functions.</p><p>When a library programmer defines a function that accepts continuations to handle results
and end cases, such as in the <span class="RktSym">x-hash-ref</span> function above, he can not know in
advance the arguments for the continuation function.  Rather he must dictate these back to
the programmer as part of the definition of the library function.  However, such dictations
could easily create artificial constraints.</p><p>Continuations when invoked in a library routine can only expect to see the arguments to
the function call and any implementation invariant values that are intrinsic to the
library function&rsquo;s behavior.  For example <span class="RktSym">x-hash-ref</span> these values include the
table, the key, the value found when one is found, and the other continuation arguments.</p><p>In addition there is an expectation that continuations are for handling results and end
cases, where such end cases would conventionally be exceptions.  They are not intended to
be part of the functionality for the library function itself.  For partitioning
functionality the library function should call helper functions and other library
functions.  These functions may indeed require values specific to the library function
implementation.</p><p>I&rsquo;ve contemplated some alternatives to passing additional information to continuation
functions.</p><p>One approach was to define a new syntax object to define functions, one where
continuations are given explicitly, the outer function call argument would then be passed
to continuations in a keyword argument.  However, this approach made defining
continuations a bit messy and confusing as all continuations given to library functions
would have to define keywords for arguments they typically do not use.</p><p>In an alternative approach, continuations are provided to the function definition syntax
as pairs. The first of the pair being be the continuation function as before, and the
second of the pair being a quoted list of arguments.  Then at the point the continuation
is invoked it would be applied to the arguments.  The user of the library function could
then state exactly what he wants passed to the continuation within the scope of the
continuation call.</p><p>The advantage with this alternative is that the creator of the continuation function can
specify what arguments are needed.  Disadvantages include that the continue may specify
implementation specific variables,  should the continuation be passed to a helper function,
the continuation can not refer to arguments to the outer call as the context will have changed,
and thirdly it is a bit tedious to have to yet again provide argument declaration list every time
a continuation is passed as an argument.   We could make agreement with the programmer not
to look at implementation state, or face a maintenance issue.  We could constrain library code
to make sure that arguments are always visible.  This could be a viable approach.</p><p>As a third option the library routine could pack up everything that could possibly
relevant to a continuation function in a list, or hash table, and then pass it as the
first argument.  For the most common case of a the simple continuation function
definition, the first argument would then be called something like &rsquo;state&rsquo;, and simply not
used.  Hence the overhead for supporting uncommon complex responses remains low for the
continuation.  However, it is fairly high for the library functions, which must pack up
and pass all the potentially relevant state.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;6.1&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;6.1&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<a href="Why_Multiple_Continuations_are_Needed.html" title="backward to &quot;3.2.3 Why Multiple Continuations are Needed&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Multiple_Execution_Path_Exits_Architecture.html" title="up to &quot;3.2 Multiple Execution Path Exits Architecture&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="More_on_the_Function-Args_Pair_Option.html" title="forward to &quot;3.2.5 More on the Function-Args Pair Option&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>