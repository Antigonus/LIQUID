<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>1&nbsp;LIQUID guide</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">LIQUID library</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">LIQUID guide</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="LIQUID_reference.html" class="tocviewlink" data-pltdoc="x">LIQUID reference</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>1&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">LIQUID guide</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">1.1&nbsp;</td><td><a href="#%28part._db-lib%29" class="tocviewlink" data-pltdoc="x">db-<wbr></wbr>lib guide</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#%28part._db-lib%29" class="tocsubseclink" data-pltdoc="x">db-<wbr></wbr>lib guide</a></td></tr><tr><td><span class="tocsublinknumber">1.1.1<tt>&nbsp;</tt></span><a href="#%28part._.A_.L.I.S.P_friendly_.Database_.Interface%29" class="tocsubseclink" data-pltdoc="x">A LISP friendly Database Interface</a></td></tr><tr><td><span class="tocsublinknumber">1.1.2<tt>&nbsp;</tt></span><a href="#%28part._.Program_.Level_.Type_.Interpretation%29" class="tocsubseclink" data-pltdoc="x">Program Level Type Interpretation</a></td></tr><tr><td><span class="tocsublinknumber">1.1.3<tt>&nbsp;</tt></span><a href="#%28part._.Explicit_.Key_.Management%29" class="tocsubseclink" data-pltdoc="x">Explicit Key Management</a></td></tr><tr><td><span class="tocsublinknumber">1.1.4<tt>&nbsp;</tt></span><a href="#%28part._.Fetch_by_.Match%29" class="tocsubseclink" data-pltdoc="x">Fetch by Match</a></td></tr><tr><td><span class="tocsublinknumber">1.1.5<tt>&nbsp;</tt></span><a href="#%28part.__with__.Contexts%29" class="tocsubseclink" data-pltdoc="x">&rsquo;with&rsquo; Contexts</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">6.1</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="index.html" title="backward to &quot;LIQUID library&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;LIQUID library&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="LIQUID_reference.html" title="forward to &quot;2 LIQUID reference&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>1<tt>&nbsp;</tt><a name="(part._.L.I.Q.U.I.D_guide)"></a>LIQUID guide</h3><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._db-lib%29" class="toclink" data-pltdoc="x">1.1<span class="hspace">&nbsp;</span>db-lib guide</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.A_.L.I.S.P_friendly_.Database_.Interface%29" class="toclink" data-pltdoc="x">1.1.1<span class="hspace">&nbsp;</span>A LISP friendly Database Interface</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Program_.Level_.Type_.Interpretation%29" class="toclink" data-pltdoc="x">1.1.2<span class="hspace">&nbsp;</span>Program Level Type Interpretation</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Explicit_.Key_.Management%29" class="toclink" data-pltdoc="x">1.1.3<span class="hspace">&nbsp;</span>Explicit Key Management</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Fetch_by_.Match%29" class="toclink" data-pltdoc="x">1.1.4<span class="hspace">&nbsp;</span>Fetch by Match</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part.__with__.Contexts%29" class="toclink" data-pltdoc="x">1.1.5<span class="hspace">&nbsp;</span>&rsquo;with&rsquo; Contexts</a></p></td></tr></table><h4>1.1<tt>&nbsp;</tt><a name="(part._db-lib)"></a><a name="(mod-path._liquid/db-lib)"></a>db-lib guide</h4><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">require</span></span></span><span class="stt"> </span><a href="#%28mod-path._liquid%2Fdb-lib%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">liquid/db-lib</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <span class="stt">liquid-lib</span></span></td></tr></table></div><div class="SIntrapara">The <a href="#%28mod-path._liquid%2Fdb-lib%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">liquid/db-lib</span></a> library provides tools
for creating, deleting, and using tables in a database.</div></p><h5>1.1.1<tt>&nbsp;</tt><a name="(part._.A_.L.I.S.P_friendly_.Database_.Interface)"></a>A LISP friendly Database Interface</h5><p>The following sections describe features of a simplified database interface useful
   for LISP programs that desire to have persistant relaitonal storage of data.</p><p>Due to these simplications this interface might not be useful when applied to a
   database that has been created by other means which make use of unrecognized
   features and types.</p><h5>1.1.2<tt>&nbsp;</tt><a name="(part._.Program_.Level_.Type_.Interpretation)"></a>Program Level Type Interpretation</h5><p>In a conventional table we are given a fixed number of columns and an indefinite number
   of rows.  Each column has a name and a type.</p><p>It is the type we take issue with here, as it is difficult for a contrived interface to
   have to deal with the difference in interpretation of type by the database server, the
   SQL language, and by LISP itself. One of the more serious divergences is that LISP
   programrans tend to deal with arbitrary length types, whereas databases typically have
   fixed length types.  The only common arbitrary length type in databases is that of
   text.</p><p>In order to circumvent these isssues of conversions and concommitant exceptions, the
   db-lib sets the type for all columns to text.  As all LISP types convert to and from
   text, this is actually a liberating feature rather than a constraining one.  Any type
   conversions then occur on the LISP side.  As text can be ordered, the database can
   still build indexes and perform comparisons.  One might even wonder in this day and age
   of 64 bit words if using text is even much of a constraint, as most any integer looks
   like a string of 8 characters.</p><p>This choice also relieves the SQL interface and interpreter from having to perform
   double type conversion, first to text, and the to the destination type, or vice versa.</p><h5>1.1.3<tt>&nbsp;</tt><a name="(part._.Explicit_.Key_.Management)"></a>Explicit Key Management</h5><p>A nagging problem in databases has been the limited number of keys available and
   lack of explicit management of keys within keyspaces.  Hence we provide LISP with
   direct access to a keyspace allocator and a key allocator.</p><p>Accordingly, when a program desires to have a unique key within a given keyspace, the
   program presents the keyspace to the interface and then the interface returns a unique
   key.  This is an allocation operation.  The program may later deallocate the key.  For
   record IDs the keyspace is typically the same as the table name and the record ID is
   then a uniquely allocated key.  It is up to the program to explicitly deallocate the
   key upon deleting a record.</p><h5>1.1.4<tt>&nbsp;</tt><a name="(part._.Fetch_by_.Match)"></a>Fetch by Match</h5><p>We don&rsquo;t pass SQL through this interface. Instead all operations have function names.
   In order to fetch data we perform patter matching.  Of course we wish the server would
   do the pattern matching for us, but until someone implements a server side program for
   this, we do the matching on the client side, and even worse, we don&rsquo;t cache the
   fetches.  There is certainly a lot of room for improvement in our match implementation.</p><h5>1.1.5<tt>&nbsp;</tt><a name="(part.__with__.Contexts)"></a>&rsquo;with&rsquo; Contexts</h5><p>Currently the interface connects to postgresql using the user&rsquo;s role and database via
    unix credentials.  However, in the fture we will have connetion contexts, then all
    library calls will have to occur within with-connection blocks.</p><p>Transactions occur within as-transaction blocks.  The transaction is closed when
    leaving the block.</p><p>Currently transactions blocks are also semaphore blocks, thus making them all
    independent.  This will have to be changed to have separate semaphores for each
    connection.  Semaphores are needed so that the instructions in transaction blocks
    on separate threads don&rsquo;t get shuffled together on one connection.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="index.html" title="backward to &quot;LIQUID library&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;LIQUID library&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="LIQUID_reference.html" title="forward to &quot;2 LIQUID reference&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>